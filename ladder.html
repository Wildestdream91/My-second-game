<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Idle ARPG — Classement</title>
  <link rel="stylesheet" href="css/style.css" />

  <!-- Ré-affiche le lien Ladder même si masqué globalement -->
  <style>
    .topbar nav a[href="ladder.html"] {
      display: inline-block !important;
    }

    .ladder-toolbar {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
      margin: 8px 0 12px;
    }

    .ladder-toolbar .field {
      display: flex;
      gap: 6px;
      align-items: center;
    }

    table.ladder {
      width: 100%;
      border-collapse: collapse;
    }

    table.ladder th,
    table.ladder td {
      border: 1px solid #2a2a33;
      padding: 8px;
      font-size: 14px;
    }

    table.ladder th {
      background: #16161b;
      text-align: left;
    }

    table.ladder tr:nth-child(even) {
      background: #101014;
    }

    .mono {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
        "Liberation Mono", "Courier New", monospace;
    }
  </style>
</head>
<body class="bg">

  <!-- Barre de navigation -->
  <header class="topbar">
    <h1>Idle Ladder Prototype</h1>
    <nav>
      <a href="index.html">Sélection</a>
      <a href="game.html">Combat</a>
      <a href="inventory.html">Inventaire</a>
      <a href="shop.html">Campement</a>
      <a href="journal.html">Journal</a>
      <a href="ladder.html" class="active">Classement</a>
      <a href="admin.html">Admin</a>
      <button class="btn" onclick="GameCore.newGame()">Nouvelle partie</button>
    </nav>
  </header>

  <!-- Contenu principal -->
  <main class="columns">
    <section class="panel">
      <h2>Classement local</h2>

      <!-- Outils du ladder -->
      <div class="ladder-toolbar">
        <button class="btn primary" id="btnSubmit">Publier ma partie</button>

        <div class="field">
          <label class="muted">Filtrer classe :</label>
          <select id="fltClass">
            <option value="">Toutes</option>
            <option>Barbare</option>
            <option>Sorcieres</option>
            <option>Paladin</option>
            <option>Necromancien</option>
            <option>Amazone</option>
            <option>Assassin</option>
            <option>Druide</option>
          </select>
        </div>

        <div class="field">
          <label class="muted">Trier par :</label>
          <select id="sortBy">
            <option value="score">Score</option>
            <option value="level">Niveau</option>
            <option value="gold">Or</option>
            <option value="time">Temps</option>
            <option value="date">Date</option>
          </select>
        </div>

        <button class="btn" id="btnExport">Exporter</button>
        <button class="btn" id="btnImport">Importer</button>
        <button class="btn" id="btnClear">Vider</button>
      </div>

      <div class="muted small">
        Le score combine niveau, progression d’XP, boss vaincus, or et vitesse (mieux = plus rapide).
      </div>

      <!-- Tableau -->
      <div style="overflow:auto; margin-top:10px">
        <table class="ladder" id="ladderTable" aria-describedby="Classement local">
          <thead>
            <tr>
              <th>#</th>
              <th>Joueur</th>
              <th>Classe</th>
              <th>Niv.</th>
              <th>XP %</th>
              <th>Or</th>
              <th>Boss</th>
              <th>Zone</th>
              <th>Diff.</th>
              <th>Temps</th>
              <th>Score</th>
              <th>Date</th>
            </tr>
          </thead>
          <tbody id="ladderBody">
            <tr>
              <td colspan="12" class="muted">Aucune entrée… publie ta partie !</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
  </main>

  <!-- Scripts -->
  <script src="js/core.v3.js"></script>
  <script src="js/zones.js"></script>
  <script src="js/ladder.js"></script>
  <script>
    (function () {
      GameCore.load(); // pas de redirection forcée
      Ladder.render();

      document.getElementById("btnSubmit").onclick = () =>
        Ladder.submitFromCurrent();

      document.getElementById("btnExport").onclick = () =>
        Ladder.exportBoard();

      document.getElementById("btnImport").onclick = () =>
        Ladder.importBoard();

      document.getElementById("btnClear").onclick = () =>
        Ladder.clearBoard();

      document.getElementById("fltClass").onchange = () =>
        Ladder.render();

      document.getElementById("sortBy").onchange = () =>
        Ladder.render();
    })();
  </script>
</body>
</html>
