<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Idle ARPG — Sélection</title>
  <link rel="stylesheet" href="css/style.css"/>
</head>
<body class="bg">
<header class="topbar">
  <h1>Idle Ladder Prototype</h1>
  <nav>
    <a href="index.html" class="active">Sélection</a>
    <a href="game.html">Combat</a>
    <a href="inventory.html">Inventaire</a>
    <a href="shop.html">Campement</a>
    <a href="journal.html">Journal</a>
    <!-- <a href="ladder.html">Classement</a> -->
    <a href="admin.html">Admin</a>
    <button class="btn" onclick="GameCore.newGame()">Nouvelle partie</button>
  </nav>
</header>

<main class="columns">
  <section class="panel">
    <h2>Créer un personnage</h2>

    <label style="display:block;margin-bottom:8px">Pseudo
      <input id="pName" type="text" placeholder="Ton pseudo..."/>
    </label>

    <label style="display:block;margin-bottom:8px">Classe
      <select id="pClass">
        <option value="Barbare">Barbare</option>
        <option value="Sorcieres">Sorcière</option>
        <option value="Paladin">Paladin</option>
        <option value="Necromancien">Nécromancien</option>
        <option value="Amazone">Amazone</option>
        <option value="Assassin">Assassin</option>
        <option value="Druide">Druide</option>
      </select>
    </label>

    <button class="btn primary" id="btnCreate">Créer</button>
  </section>

  <section class="panel">
    <h2>Reprendre une partie</h2>
    <p class="muted">Si une sauvegarde est détectée, tu seras redirigé vers le combat.</p>
    <button class="btn" id="btnResume">Reprendre</button>
  </section>
</main>

<script src="js/core.v3.js"></script>
<script>
(function(){
  document.getElementById('btnCreate').onclick = function(){
    const name  = String(document.getElementById('pName').value||'').trim();
    const klass = String(document.getElementById('pClass').value||'Barbare');
    if(!name){ alert("Entre un pseudo"); return; }
    if(!window.GameCore){ alert("Core manquant"); return; }
    GameCore.createNewGame(name, klass);
    location.href="game.html";
  };
  document.getElementById('btnResume').onclick = function(){
    try{
      const raw = localStorage.getItem("idleARPG_state");
      if(!raw){ alert("Aucune sauvegarde trouvée."); return; }
      JSON.parse(raw);
      location.href="game.html";
    }catch(e){
      alert("⚠️ Sauvegarde corrompue. On réinitialise…");
      localStorage.removeItem("idleARPG_state");
    }
  };
})();
</script>
</body>
</html>
