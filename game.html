<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>IdleARPG - Combat</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <main class="layout">
    
    <!-- Colonne gauche : joueur -->
    <section class="panel">
      <h2>Personnage</h2>

      <!-- Barres -->
      <div class="bars">
        <div class="bar hp">
          <div class="bar-fill" id="barHpFill"></div>
          <div class="bar-text" id="barHpText">HP 0/0</div>
        </div>
        <div class="bar mana">
          <div class="bar-fill" id="barManaFill"></div>
          <div class="bar-text" id="barManaText">Mana 0/0</div>
        </div>
        <div class="bar xp">
          <div class="bar-fill" id="barXpFill"></div>
          <div class="bar-text" id="barXpText">XP 0/0</div>
        </div>
      </div>

      <!-- Stats rapides -->
      <div class="statsBox" style="margin-top:10px">
        <div>
          ATQ <b id="cAtk">0</b> • DEF <b id="cDef">0</b> • Crit <b id="cCrit">0</b>% • MF <b id="cMF">0</b>%
        </div>
      </div>

      <!-- Fiche perso détaillée -->
      <h3 style="margin-top:12px">Fiche personnage</h3>
      <div class="charSheet">
        <div><b id="charName">—</b> (<span id="charClass">—</span>)</div>
        <div>Niveau <b id="charLevel">1</b></div>
        <div>Or : <b id="charGold">0</b></div>
        <hr/>
        <div>FOR : <b id="charStr">0</b> <button onclick="GameCore.spendStatPoint('str')">+</button></div>
        <div>DEX : <b id="charDex">0</b> <button onclick="GameCore.spendStatPoint('dex')">+</button></div>
        <div>VIT : <b id="charVit">0</b> <button onclick="GameCore.spendStatPoint('vit')">+</button></div>
        <div>ENE : <b id="charEne">0</b> <button onclick="GameCore.spendStatPoint('ene')">+</button></div>
        <div>Pts dispo : <b id="charPts">0</b></div>
      </div>

      <!-- Carte -->
      <h3 style="margin-top:12px">Carte</h3>
      <div class="grid" style="grid-template-columns:1fr 1fr;gap:8px">
        <div>
          <label>Acte
            <select id="selAct"></select>
          </label>
        </div>
        <div>
          <label>Zone
            <select id="selZone"></select>
          </label>
        </div>
      </div>
      <div style="display:flex; gap:8px; margin-top:8px">
        <button class="btn primary" id="btnGo">Aller</button>
        <button class="btn" id="btnStop">Stop</button>
      </div>
    </section>

    <!-- Colonne droite : combat -->
    <section class="panel">
      <h2>Combat</h2>
      <div id="enemyCard" class="enemyCard"></div>
      <div id="logBox" class="logBox"></div>
    </section>

  </main>

  <script src="js/core.v3.js"></script>
  <script src="js/zones.js"></script>
  <script src="js/combat.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded",function(){
      Zones.fillActs(document.getElementById("selAct"));
      Zones.fillZonesForAct(
        document.getElementById("selAct"),
        document.getElementById("selZone"),
        GameCore.canTravelTo
      );
      document.getElementById("selAct").onchange=function(){
        Zones.fillZonesForAct(
          document.getElementById("selAct"),
          document.getElementById("selZone"),
          GameCore.canTravelTo
        );
      };
      document.getElementById("btnGo").onclick=function(){
        var act=document.getElementById("selAct").value;
        var zone=document.getElementById("selZone").value;
        if(!GameCore.canTravelTo(zone)){
          alert("Zone verrouillée ! Boss non vaincu.");
          return;
        }
        GameCore.travelTo(zone);
        Combat.spawn();
      };
      document.getElementById("btnStop").onclick=function(){
        localStorage.setItem("idleARPG_auto","0");
        GameCore.log("⏹️ Combat arrêté");
      };
    });
  </script>
</body>
</html>
